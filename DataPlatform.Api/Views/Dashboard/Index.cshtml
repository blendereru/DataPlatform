@{
Layout = "_Layout";
}

<h2>Real-Time Dashboard</h2>

<div class="card p-3">
    <p><strong>Total Events:</strong> <span id="totalEvents">0</span></p>
    <p><strong>Last Event Payload:</strong> <span id="lastPayload">-</span></p>
    <p><strong>Last Event ID:</strong> <span id="lastId">-</span></p>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.0/signalr.min.js"></script>

<script>
    const connection = new signalR.HubConnectionBuilder()
        .withUrl("/datahub")
        .build();

    connection.on("statsUpdated", data => {
        document.getElementById("totalEvents").innerText = data.totalEvents;
        document.getElementById("lastPayload").innerText = data.lastEventPayload;
        document.getElementById("lastId").innerText = data.lastEventId;
    });

    connection.start().catch(err => console.error(err));
</script>
